<!doctype html>
<html lang="zh-cn">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>JavaFXä¸Kotlinçš„Mainå‡½æ•° | LeeReindeer&#39;s blog</title>
    <meta property="og:title" content="JavaFXä¸Kotlinçš„Mainå‡½æ•° - LeeReindeer&#39;s blog">
    <meta property="og:type" content="article">
    
    <meta property="article:published_time" content='2018-08-02T20:31:21&#43;08:00'>
    
    
    <meta property="article:modified_time" content='2018-08-02T20:31:21&#43;08:00'>
    
    <meta name="Keywords" content="">
    <meta name="description"
        content="æ™šä¸Šæƒ³åšä¸ªå°åº”ç”¨ï¼Œä¸æƒ³ç”¨ ä¸‘é™‹çš„swingï¼ˆç¡®ä¿¡ï¼‰ã€‚äºæ˜¯è¯•äº†è¯•JavaFXã€‚MVC æ¨¡å¼ï¼ŒXML å’Œ Scene Builder  è®¾è®¡ UIï¼Œè®¾è®¡å‡ºçš„ UI é¢œå€¼è¿˜é«˜ã€‚è¿™æ ·ä¸€çœ‹è¿˜æ˜¯æ¯”è¾ƒç†Ÿæ‚‰çš„å˜›ï¼Œå¥½åƒå’Œ Android çš„å¥—è·¯å·®ä¸å¤šã€‚
å½“ç„¶è¿˜æ˜¯è¦ç”¨Kotlinã€‚ä¸è¿‡åœ¨å†™Mainå‡½æ•°çš„æ—¶å€™å°±é‡åˆ°é—®é¢˜äº†ï¼Œç®€ç›´æ°”ç‚¸ï¼ˆ
ä¸‰æ¬¡å°è¯•
ä¸€
é¦–å…ˆï¼Œåœ¨ Java é‡Œçš„ä»£ç åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š
public class Main extends Application {
    //...
    public static void main(String[] args) {
        launch(args);
    }
}
æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚
é‚£ä¹ˆåœ¨ Kotlin ä¸­ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯ Top level çš„ Main å‡½æ•°ï¼š
fun main(args: Array&lt;String&gt;) = Application.launch(*args)

class Main : Application() {
	//...
}
">
    
    <meta name="author" content="LeeR">
    <meta property="og:url" content="https://leer.moe/2018/08/02/javafx_main_kotlin/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    <link href="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" rel="stylesheet">
    

    
    
</head>

<body>
  <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://leer.moe/">
                        LeeReindeer&#39;s blog
                    </a>
                
                <p class="description">Dive in</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="https://leer.moe/">é¦–é¡µ</a>
                    
                    <a  href="https://leer.moe/archives/" title="å½’æ¡£">å½’æ¡£</a>
                    
                    <a  href="https://leer.moe/about/" title="å…³äº">å…³äº</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

  <div id="body">
    
    <div class="container">
      <div class="col-group">

        <div class="col-8" id="main">
          
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 260px;
        margin-top: 1%;
        right: 8.5%;
         
        margin-right: 1%;
        padding: 5px 10px;
        font-size: 12px;
         
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
         
         
         
        word-wrap: break-word;
        line-height: 1.5;
         
         
         
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 18px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
        color: #ba3925;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h2 class="post-toc-title">JavaFXä¸Kotlinçš„Mainå‡½æ•°</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ol>
    <li><a href="#ä¸‰æ¬¡å°è¯•">ä¸‰æ¬¡å°è¯•</a>
      <ol>
        <li><a href="#ä¸€">ä¸€</a></li>
        <li><a href="#äºŒ">äºŒ</a></li>
        <li><a href="#ä¸‰">ä¸‰</a></li>
      </ol>
    </li>
    <li><a href="#é¢å‘-stack-overflow">é¢å‘ stack overflow</a></li>
  </ol>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            
            
            
            

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">JavaFXä¸Kotlinçš„Mainå‡½æ•°</h1>
        </header>
        <date class="post-meta meta-date">
            2018å¹´8æœˆ2æ—¥
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='https://leer.moe/categories/%E8%87%AA%E4%B9%A0%E5%AE%A4'>è‡ªä¹ å®¤</a></span>
            
        </div>
        
        
        <div class="post-meta">
            <span>|</span>
            <span class="meta-category">881 words</span>
        </div>
        
        
        
        <div class="post-content">
            <p>æ™šä¸Šæƒ³åšä¸ªå°åº”ç”¨ï¼Œä¸æƒ³ç”¨ ä¸‘é™‹çš„<code>swing</code>ï¼ˆç¡®ä¿¡ï¼‰ã€‚äºæ˜¯è¯•äº†è¯•<code>JavaFX</code>ã€‚MVC æ¨¡å¼ï¼ŒXML å’Œ <code>Scene Builder</code>  è®¾è®¡ UIï¼Œè®¾è®¡å‡ºçš„ UI é¢œå€¼è¿˜é«˜ã€‚è¿™æ ·ä¸€çœ‹è¿˜æ˜¯æ¯”è¾ƒç†Ÿæ‚‰çš„å˜›ï¼Œå¥½åƒå’Œ Android çš„å¥—è·¯å·®ä¸å¤šã€‚</p>
<p>å½“ç„¶è¿˜æ˜¯è¦ç”¨<code>Kotlin</code>ã€‚ä¸è¿‡åœ¨å†™<code>Main</code>å‡½æ•°çš„æ—¶å€™å°±é‡åˆ°é—®é¢˜äº†ï¼Œç®€ç›´æ°”ç‚¸ï¼ˆ</p>
<h2 id="ä¸‰æ¬¡å°è¯•">ä¸‰æ¬¡å°è¯•</h2>
<h3 id="ä¸€">ä¸€</h3>
<p>é¦–å…ˆï¼Œåœ¨ Java é‡Œçš„ä»£ç åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> <span style="color:#000;font-weight:bold">extends</span> Application <span style="color:#000;font-weight:bold">{</span>
    <span style="color:#998;font-style:italic">//...
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
        launch<span style="color:#000;font-weight:bold">(</span>args<span style="color:#000;font-weight:bold">);</span>
    <span style="color:#000;font-weight:bold">}</span>
<span style="color:#000;font-weight:bold">}</span>
</code></pre></div><p>æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚</p>
<p>é‚£ä¹ˆåœ¨ Kotlin ä¸­ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¯ <code>Top level</code> çš„ Main å‡½æ•°ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#000;font-weight:bold">fun</span> <span style="color:#900;font-weight:bold">main</span>(args: Array&lt;String&gt;) = Application.launch(*args)

<span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> : Application() {
	<span style="color:#998;font-style:italic">//...
</span><span style="color:#998;font-style:italic"></span>}
</code></pre></div><p>ç»“æœä¼šæŠ¥é”™ï¼š</p>
<p><code>Exception in thread &quot;main&quot; java.lang.RuntimeException: Error: class moe.leer.MainKt is not a subclass of javafx.application.Application</code>ï¼Œå¾ˆæ˜æ˜¾æˆ‘çŒœæƒ³ è¿™ä¸ª<code>Main</code>å‡½æ•°æ˜¯å¦ä¸€ä¸ªç±»çš„ <code>Main</code> å‡½æ•°ï¼Œè€Œä¸æ˜¯ <code>Main</code> ç±»çš„ã€‚</p>
<p>åˆ©ç”¨ IDEA çš„ Kotlin Bytecode å·¥å…·å¯ä»¥çœ‹åˆ°å­—èŠ‚ç ï¼Œå†æŠŠå­—èŠ‚ç åç¼–è¯‘ï¼Œå¯ä»¥çœ‹åˆ° Java çš„å®ç°ã€‚</p>
<p>
<a data-fancybox="gallery" href="/images/decompile_kotlin_javafx.png">
  <img class="mx-auto" alt="1533215976909" src="/images/decompile_kotlin_javafx.png" />
</a>
</p>
<p>Java çš„å®ç°ç¡®å®æ˜¯å†åˆ›å»ºä¸€ä¸ªç±»ï¼Œæ¥å®ç°<code>Top level</code> çš„ Main å‡½æ•°ï¼šï¼‰</p>
<h3 id="äºŒ">äºŒ</h3>
<p>æ¥ä¸‹æ¥å°è¯•äº†<code>companion object </code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> : Application() {  
	<span style="color:#998;font-style:italic">//...
</span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">companion</span> <span style="color:#000;font-weight:bold">object</span> {
    	<span style="color:#3c5d5d;font-weight:bold">@JvmStatic</span> <span style="color:#000;font-weight:bold">fun</span> <span style="color:#900;font-weight:bold">main</span>(args: Array&lt;String&gt;) {
      	launch(*args)
    }
}
</code></pre></div><p>ç»“æœç±»ä¼¼ä¸ç¬¬ä¸€ä¸ªå°è¯•ï¼Œè¿˜æ˜¯ç›¸åŒçš„æŠ¥é”™ï¼š<code>java.lang.RuntimeException: Error: class moe.leer.Main$Companion is not a subclass of javafx.application.Application</code>ã€‚é‚£ä¹Ÿå¯ä»¥è‚¯å®š <code>companion object </code>æ˜¯åˆ›å»ºäº†å†…éƒ¨ç±»æ¥å®ç°çš„ã€‚</p>
<h3 id="ä¸‰">ä¸‰</h3>
<p>æœ€åå‡ºåœºçš„æ˜¯<code>object</code>ï¼ŒKotlin é‡Œå•ä¾‹æ¨¡å¼çš„å®ç°ã€‚</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin">
<span style="color:#000;font-weight:bold">object</span> <span style="color:#458;font-weight:bold">Main</span> : Application() {

  <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">lateinit</span> <span style="color:#000;font-weight:bold">var</span> stage: Stage
  <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">lateinit</span> <span style="color:#000;font-weight:bold">var</span> rootLayout: BorderPane

  <span style="color:#3c5d5d;font-weight:bold">@JvmStatic</span> <span style="color:#000;font-weight:bold">fun</span> <span style="color:#900;font-weight:bold">main</span>(args: Array&lt;String&gt;) {
    launch(*args)
  }
}
</code></pre></div><p>è¿™æ¬¡çš„é”™è¯¯ä¿¡æ¯ç»ˆäºå’Œå‰ä¸¤æ¬¡ä¸åŒäº†ï¼ˆç¬‘ï¼‰</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">java<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">lang</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">reflect</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">InvocationTargetException</span>
	at com<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">sun</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">javafx</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">application</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">LauncherImpl</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">launchApplicationWithArgs</span><span style="color:#000;font-weight:bold">(</span>LauncherImpl<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">java</span><span style="color:#000;font-weight:bold">:</span>389<span style="color:#000;font-weight:bold">)</span>
	at sun<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">launcher</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">LauncherHelper$FXHelper</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">main</span><span style="color:#000;font-weight:bold">(</span>LauncherHelper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">java</span><span style="color:#000;font-weight:bold">:</span>767<span style="color:#000;font-weight:bold">)</span>
Caused by<span style="color:#000;font-weight:bold">:</span> java<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">lang</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">RuntimeException</span><span style="color:#000;font-weight:bold">:</span> Unable to construct Application instance<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">moe</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">leer</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">Main</span>
</code></pre></div><p>é‚£ä¹ˆåº”è¯¥æ˜¯åå°„çš„æ—¶å€™ï¼Œè°ƒç”¨<code>Main</code>æ–¹æ³•å¤±è´¥äº†ï¼Œå…³äºåå°„çš„æˆ‘ä¹Ÿæ˜¯æµ…å°è¾„æ­¢ï¼Œæ‰€ä»¥è§£é‡Šä¸äº†äº†ã€‚</p>
<h2 id="é¢å‘-stack-overflow">é¢å‘ stack overflow</h2>
<p>
<a data-fancybox="gallery" href="/images/wordless.jpg">
  <img class="mx-auto" alt="wordless" src="/images/wordless.jpg" />
</a>
</p>
<p><a href="https://stackoverflow.com/questions/34833258/kotlin-basic-javafx-application">Kotlin. Basic JavaFX application</a>ï¼Œäºæ˜¯å°±æœ‰äº†ã€‚Stack overflow çœŸå¥½å•Šï¼ˆ</p>
<p>è‡³äºæœ€åä¸€æ¬¡ä¸ºä»€ä¹ˆä¼šæŠ¥é”™ï¼Œå¤§ä½¬æ˜¯è¿™æ ·è¯´çš„ï¼šÂ </p>
<blockquote>
<p>anÂ <a href="https://kotlinlang.org/docs/reference/object-declarations.html#object-declarations"><code>object</code>Â declaration</a>Â in Kotlin is a singleton, so it only has one instance constructed by calling the private constructor when the class is initialized. JavaFX is trying to call the constructor of the class reflectively but fails because the constructor is private as it should be.</p>
</blockquote>
<p>ä¸è¿‡æˆ‘åç¼–è¯‘äº†ä¸€ä¸‹å¥½åƒæ²¡æœ‰çœ‹åˆ°æ‰€è¯´çš„<code>private constructor</code>ï¼Œæ‰€ä»¥è¿˜æ˜¯ä¸€çŸ¥åŠè§£äº†ã€‚</p>
<p>ä½†æ˜¯è§£å†³æ–¹æ³•å’Œè¿™ä¸ªæ²¡å…³ç³»ï¼Œåªæ˜¯è°ƒç”¨äº†å¦ä¸€ä¸ª<code>launch</code>å‡½æ•°è€Œå·²ï¼Œä¸è¿‡æœ€ç»ˆéƒ½æ˜¯åå°„æ¥è°ƒç”¨é‡Œé¢çš„æ–¹æ³•å§ã€‚</p>
<p>å¯ä»¥è¿™æ ·å†™ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> : Application() {

  <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">lateinit</span> <span style="color:#000;font-weight:bold">var</span> stage: Stage
  <span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">lateinit</span> <span style="color:#000;font-weight:bold">var</span> rootLayout: BorderPane

  <span style="color:#000;font-weight:bold">companion</span> <span style="color:#000;font-weight:bold">object</span> {
    <span style="color:#3c5d5d;font-weight:bold">@JvmStatic</span> <span style="color:#000;font-weight:bold">fun</span> <span style="color:#900;font-weight:bold">main</span>(args: Array&lt;String&gt;) {
      launch(Main<span style="color:#000;font-weight:bold">::</span><span style="color:#000;font-weight:bold">class</span>.java, *args)
    }
  }
}
</code></pre></div><p>ä½ ä¹Ÿå¯ä»¥ç”¨ <code>Top level</code> çš„ Main å‡½æ•°ï¼š</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-kotlin" data-lang="kotlin"><span style="color:#000;font-weight:bold">fun</span> <span style="color:#900;font-weight:bold">main</span>(args: Array&lt;String&gt;) = Application.launch(Main<span style="color:#000;font-weight:bold">::</span><span style="color:#000;font-weight:bold">class</span>.java)
</code></pre></div><p>ğŸ‰ğŸ‰ğŸ‰ å¯ä»¥æ…¢æ…¢ç©<code>JavaFX</code>äº†ã€‚</p>
        </div>

        


        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/2017/11/29/android-kotlin-style-guides/">Android Kotlin ä»£ç è§„èŒƒ</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://leer.moe/tags/kotlin'>Kotlin</a></li>
                
                <li><a href='https://leer.moe/tags/javafx'>JavaFX</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "LeeReindeer/LeeReindeer.github.io"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

        </div>
        
        
        
        
      </div>
    </div>
  </div>
  <footer id="footer">
    <div class="container">
        &copy; 2021 <a href="https://leer.moe/">LeeReindeer&#39;s blog</a>.
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>
        <a href="https://github.com/LeeReindeer/maupassant-hugo" target="_blank">maupassant</a>.
        
    </div>
    <div class="container" id="showDays"></div>
</footer>
<script type="text/javascript" src='/js/sitedate.js' async=""></script>





<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>








<script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "ed681cb7afd944b3befe979a9f047e05"}'></script>

</body>

</html>